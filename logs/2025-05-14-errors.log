ERROR | app.services.workflow.manager | (logging.py:121) | Error processing message for 923408957390
State: SCHEDULE_SELECTION
Message: 'now'

Traceback (most recent call last):
  File "/workspaces/elevate2ai/app/services/workflow/manager.py", line 136, in _message_processor
    await handler(client_id, message_text.strip().lower())
  File "/workspaces/elevate2ai/app/services/workflow/handlers/scheduling.py", line 13, in handle
    context = WorkflowContext(**self.state_manager.get_context(client_id))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/elevate2ai/.venv/lib/python3.12/site-packages/pydantic/main.py", line 253, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 2 validation errors for WorkflowContext
media_metadata.original_url
  Input should be a valid dictionary [type=dict_type, input_value='https://lookaside.fbsbx....if4uvft6z8wqvxvgtzpxttw', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/dict_type
media_metadata.media_type
  Input should be a valid dictionary [type=dict_type, input_value='image', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/dict_type

Stack:
  File "<string>", line 1, in <module>
  File "/home/codespace/.python/current/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/home/codespace/.python/current/lib/python3.12/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
  File "/home/codespace/.python/current/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/codespace/.python/current/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/workspaces/elevate2ai/.venv/lib/python3.12/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "/workspaces/elevate2ai/.venv/lib/python3.12/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/home/codespace/.python/current/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/home/codespace/.python/current/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/home/codespace/.python/current/lib/python3.12/asyncio/base_events.py", line 671, in run_until_complete
    self.run_forever()
  File "/home/codespace/.python/current/lib/python3.12/asyncio/base_events.py", line 638, in run_forever
    self._run_once()
  File "/home/codespace/.python/current/lib/python3.12/asyncio/base_events.py", line 1971, in _run_once
    handle._run()
  File "/home/codespace/.python/current/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/workspaces/elevate2ai/app/services/workflow/manager.py", line 158, in _message_processor
    log_exception(self.logger, error_msg, e)
  File "/workspaces/elevate2ai/app/services/common/logging.py", line 121, in log_exception
    logger.error(f"{message}\n{tb_text}")
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1684, in _log
    self.handle(record)
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1700, in handle
    self.callHandlers(record)
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1762, in callHandlers
    hdlr.handle(record)
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1028, in handle
    self.emit(record)

ERROR | app.services.content.switchboard | (switchboard.py:174) | HTTP error generating image: Server error '502 Bad Gateway' for url 'https://api.canvas.switchboard.ai'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/502
Stack:
  File "<string>", line 1, in <module>
  File "/home/codespace/.python/current/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/home/codespace/.python/current/lib/python3.12/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
  File "/home/codespace/.python/current/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/codespace/.python/current/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/workspaces/elevate2ai/.venv/lib/python3.12/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "/workspaces/elevate2ai/.venv/lib/python3.12/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/home/codespace/.python/current/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/home/codespace/.python/current/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/home/codespace/.python/current/lib/python3.12/asyncio/base_events.py", line 671, in run_until_complete
    self.run_forever()
  File "/home/codespace/.python/current/lib/python3.12/asyncio/base_events.py", line 638, in run_forever
    self._run_once()
  File "/home/codespace/.python/current/lib/python3.12/asyncio/base_events.py", line 1971, in _run_once
    handle._run()
  File "/home/codespace/.python/current/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/workspaces/elevate2ai/app/services/workflow/manager.py", line 136, in _message_processor
    await handler(client_id, message_text.strip().lower())
  File "/workspaces/elevate2ai/app/services/workflow/handlers/execution.py", line 49, in handle_confirmation
    await self.generate_platform_images(client_id)
  File "/workspaces/elevate2ai/app/services/workflow/handlers/execution.py", line 250, in generate_platform_images
    image_response = create_image(
  File "/workspaces/elevate2ai/app/services/content/switchboard.py", line 206, in create_image
    response = canvas.generate_image(payload)
  File "/workspaces/elevate2ai/app/services/content/switchboard.py", line 174, in generate_image
    self.logger.error(f"HTTP error generating image: {e}")
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1684, in _log
    self.handle(record)
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1700, in handle
    self.callHandlers(record)
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1762, in callHandlers
    hdlr.handle(record)
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1028, in handle
    self.emit(record)

ERROR | create_image | (switchboard.py:209) | Failed to create image: Server error '502 Bad Gateway' for url 'https://api.canvas.switchboard.ai'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/502
Stack:
  File "<string>", line 1, in <module>
  File "/home/codespace/.python/current/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/home/codespace/.python/current/lib/python3.12/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
  File "/home/codespace/.python/current/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/codespace/.python/current/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/workspaces/elevate2ai/.venv/lib/python3.12/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "/workspaces/elevate2ai/.venv/lib/python3.12/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/home/codespace/.python/current/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/home/codespace/.python/current/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/home/codespace/.python/current/lib/python3.12/asyncio/base_events.py", line 671, in run_until_complete
    self.run_forever()
  File "/home/codespace/.python/current/lib/python3.12/asyncio/base_events.py", line 638, in run_forever
    self._run_once()
  File "/home/codespace/.python/current/lib/python3.12/asyncio/base_events.py", line 1971, in _run_once
    handle._run()
  File "/home/codespace/.python/current/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/workspaces/elevate2ai/app/services/workflow/manager.py", line 136, in _message_processor
    await handler(client_id, message_text.strip().lower())
  File "/workspaces/elevate2ai/app/services/workflow/handlers/execution.py", line 49, in handle_confirmation
    await self.generate_platform_images(client_id)
  File "/workspaces/elevate2ai/app/services/workflow/handlers/execution.py", line 250, in generate_platform_images
    image_response = create_image(
  File "/workspaces/elevate2ai/app/services/content/switchboard.py", line 209, in create_image
    logger.error(f"Failed to create image: {e}")
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1684, in _log
    self.handle(record)
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1700, in handle
    self.callHandlers(record)
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1762, in callHandlers
    hdlr.handle(record)
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1028, in handle
    self.emit(record)

ERROR | app.services.workflow.handlers.base | (execution.py:273) | Error generating image for instagram: Server error '502 Bad Gateway' for url 'https://api.canvas.switchboard.ai'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/502
Stack:
  File "<string>", line 1, in <module>
  File "/home/codespace/.python/current/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/home/codespace/.python/current/lib/python3.12/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
  File "/home/codespace/.python/current/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/codespace/.python/current/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/workspaces/elevate2ai/.venv/lib/python3.12/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "/workspaces/elevate2ai/.venv/lib/python3.12/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/home/codespace/.python/current/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/home/codespace/.python/current/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/home/codespace/.python/current/lib/python3.12/asyncio/base_events.py", line 671, in run_until_complete
    self.run_forever()
  File "/home/codespace/.python/current/lib/python3.12/asyncio/base_events.py", line 638, in run_forever
    self._run_once()
  File "/home/codespace/.python/current/lib/python3.12/asyncio/base_events.py", line 1971, in _run_once
    handle._run()
  File "/home/codespace/.python/current/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/workspaces/elevate2ai/app/services/workflow/manager.py", line 136, in _message_processor
    await handler(client_id, message_text.strip().lower())
  File "/workspaces/elevate2ai/app/services/workflow/handlers/execution.py", line 49, in handle_confirmation
    await self.generate_platform_images(client_id)
  File "/workspaces/elevate2ai/app/services/workflow/handlers/execution.py", line 273, in generate_platform_images
    self.logger.error(
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1684, in _log
    self.handle(record)
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1700, in handle
    self.callHandlers(record)
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1762, in callHandlers
    hdlr.handle(record)
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1028, in handle
    self.emit(record)

ERROR | app.api.webhook | (logging.py:121) | Error processing webhook data
Traceback (most recent call last):
  File "/workspaces/elevate2ai/app/api/webhook.py", line 113, in handle_message
    await download_media_file(
          ^^^^^^^^^^^^^^^^^^^^
TypeError: download_media_file() got multiple values for argument 'media_type'

Stack:
  File "<string>", line 1, in <module>
  File "/home/codespace/.python/current/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/home/codespace/.python/current/lib/python3.12/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
  File "/home/codespace/.python/current/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/codespace/.python/current/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/workspaces/elevate2ai/.venv/lib/python3.12/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "/workspaces/elevate2ai/.venv/lib/python3.12/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/home/codespace/.python/current/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/home/codespace/.python/current/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/home/codespace/.python/current/lib/python3.12/asyncio/base_events.py", line 671, in run_until_complete
    self.run_forever()
  File "/home/codespace/.python/current/lib/python3.12/asyncio/base_events.py", line 638, in run_forever
    self._run_once()
  File "/home/codespace/.python/current/lib/python3.12/asyncio/base_events.py", line 1971, in _run_once
    handle._run()
  File "/home/codespace/.python/current/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/workspaces/elevate2ai/.venv/lib/python3.12/site-packages/uvicorn/protocols/http/h11_impl.py", line 403, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/workspaces/elevate2ai/.venv/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "/workspaces/elevate2ai/.venv/lib/python3.12/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/workspaces/elevate2ai/.venv/lib/python3.12/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/workspaces/elevate2ai/.venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/workspaces/elevate2ai/app/middleware.py", line 38, in __call__
    return await self.app(scope, receive, send)
  File "/workspaces/elevate2ai/.venv/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/workspaces/elevate2ai/.venv/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/workspaces/elevate2ai/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/workspaces/elevate2ai/.venv/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/workspaces/elevate2ai/.venv/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/workspaces/elevate2ai/.venv/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/workspaces/elevate2ai/.venv/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/workspaces/elevate2ai/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/workspaces/elevate2ai/.venv/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/workspaces/elevate2ai/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/workspaces/elevate2ai/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/workspaces/elevate2ai/app/main.py", line 103, in webhook_handler
    return await handle_message(data)
  File "/workspaces/elevate2ai/app/api/webhook.py", line 164, in handle_message
    log_exception(logger, error_msg, e)
  File "/workspaces/elevate2ai/app/services/common/logging.py", line 121, in log_exception
    logger.error(f"{message}\n{tb_text}")
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1684, in _log
    self.handle(record)
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1700, in handle
    self.callHandlers(record)
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1762, in callHandlers
    hdlr.handle(record)
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1028, in handle
    self.emit(record)

ERROR | app.services.content.switchboard | (switchboard.py:174) | HTTP error generating image: Server error '502 Bad Gateway' for url 'https://api.canvas.switchboard.ai'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/502
Stack:
  File "<string>", line 1, in <module>
  File "/home/codespace/.python/current/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/home/codespace/.python/current/lib/python3.12/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
  File "/home/codespace/.python/current/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/codespace/.python/current/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/workspaces/elevate2ai/.venv/lib/python3.12/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "/workspaces/elevate2ai/.venv/lib/python3.12/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/home/codespace/.python/current/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/home/codespace/.python/current/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/home/codespace/.python/current/lib/python3.12/asyncio/base_events.py", line 671, in run_until_complete
    self.run_forever()
  File "/home/codespace/.python/current/lib/python3.12/asyncio/base_events.py", line 638, in run_forever
    self._run_once()
  File "/home/codespace/.python/current/lib/python3.12/asyncio/base_events.py", line 1971, in _run_once
    handle._run()
  File "/home/codespace/.python/current/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/workspaces/elevate2ai/app/services/workflow/manager.py", line 136, in _message_processor
    await handler(client_id, message_text.strip().lower())
  File "/workspaces/elevate2ai/app/services/workflow/handlers/execution.py", line 49, in handle_confirmation
    await self.generate_platform_images(client_id)
  File "/workspaces/elevate2ai/app/services/workflow/handlers/execution.py", line 250, in generate_platform_images
    image_response = create_image(
  File "/workspaces/elevate2ai/app/services/content/switchboard.py", line 206, in create_image
    response = canvas.generate_image(payload)
  File "/workspaces/elevate2ai/app/services/content/switchboard.py", line 174, in generate_image
    self.logger.error(f"HTTP error generating image: {e}")
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1684, in _log
    self.handle(record)
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1700, in handle
    self.callHandlers(record)
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1762, in callHandlers
    hdlr.handle(record)
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1028, in handle
    self.emit(record)

ERROR | create_image | (switchboard.py:209) | Failed to create image: Server error '502 Bad Gateway' for url 'https://api.canvas.switchboard.ai'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/502
Stack:
  File "<string>", line 1, in <module>
  File "/home/codespace/.python/current/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/home/codespace/.python/current/lib/python3.12/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
  File "/home/codespace/.python/current/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/codespace/.python/current/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/workspaces/elevate2ai/.venv/lib/python3.12/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "/workspaces/elevate2ai/.venv/lib/python3.12/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/home/codespace/.python/current/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/home/codespace/.python/current/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/home/codespace/.python/current/lib/python3.12/asyncio/base_events.py", line 671, in run_until_complete
    self.run_forever()
  File "/home/codespace/.python/current/lib/python3.12/asyncio/base_events.py", line 638, in run_forever
    self._run_once()
  File "/home/codespace/.python/current/lib/python3.12/asyncio/base_events.py", line 1971, in _run_once
    handle._run()
  File "/home/codespace/.python/current/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/workspaces/elevate2ai/app/services/workflow/manager.py", line 136, in _message_processor
    await handler(client_id, message_text.strip().lower())
  File "/workspaces/elevate2ai/app/services/workflow/handlers/execution.py", line 49, in handle_confirmation
    await self.generate_platform_images(client_id)
  File "/workspaces/elevate2ai/app/services/workflow/handlers/execution.py", line 250, in generate_platform_images
    image_response = create_image(
  File "/workspaces/elevate2ai/app/services/content/switchboard.py", line 209, in create_image
    logger.error(f"Failed to create image: {e}")
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1684, in _log
    self.handle(record)
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1700, in handle
    self.callHandlers(record)
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1762, in callHandlers
    hdlr.handle(record)
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1028, in handle
    self.emit(record)

ERROR | app.services.workflow.handlers.base | (execution.py:273) | Error generating image for instagram: Server error '502 Bad Gateway' for url 'https://api.canvas.switchboard.ai'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/502
Stack:
  File "<string>", line 1, in <module>
  File "/home/codespace/.python/current/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/home/codespace/.python/current/lib/python3.12/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
  File "/home/codespace/.python/current/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/codespace/.python/current/lib/python3.12/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/workspaces/elevate2ai/.venv/lib/python3.12/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "/workspaces/elevate2ai/.venv/lib/python3.12/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
  File "/home/codespace/.python/current/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/home/codespace/.python/current/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/home/codespace/.python/current/lib/python3.12/asyncio/base_events.py", line 671, in run_until_complete
    self.run_forever()
  File "/home/codespace/.python/current/lib/python3.12/asyncio/base_events.py", line 638, in run_forever
    self._run_once()
  File "/home/codespace/.python/current/lib/python3.12/asyncio/base_events.py", line 1971, in _run_once
    handle._run()
  File "/home/codespace/.python/current/lib/python3.12/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/workspaces/elevate2ai/app/services/workflow/manager.py", line 136, in _message_processor
    await handler(client_id, message_text.strip().lower())
  File "/workspaces/elevate2ai/app/services/workflow/handlers/execution.py", line 49, in handle_confirmation
    await self.generate_platform_images(client_id)
  File "/workspaces/elevate2ai/app/services/workflow/handlers/execution.py", line 273, in generate_platform_images
    self.logger.error(
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1684, in _log
    self.handle(record)
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1700, in handle
    self.callHandlers(record)
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1762, in callHandlers
    hdlr.handle(record)
  File "/home/codespace/.python/current/lib/python3.12/logging/__init__.py", line 1028, in handle
    self.emit(record)

